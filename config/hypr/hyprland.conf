source = ./colors.conf

###
### ENV
###

env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland

env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = QT_QPA_PLATFORMTHEME,kde

exec-once = hyprctl setcursor Breeze_Light 36
exec-once = systemctl --user start kanshi
exec-once = systemctl --user start hypridle plasma-polkit-agent
exec-once = systemctl --user start mako waybar swaybg-single
# Clipboard history
exec-once = wl-paste --type text  --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

misc {
	force_default_wallpaper = 0
	disable_hyprland_logo = true # :( no amine
	disable_autoreload = true
	initial_workspace_tracking = 0
}

xwayland {
	enabled = true
}

ecosystem {
	enforce_permissions = true
}

###
### STYLE
###

general {
	gaps_in = 5
	gaps_out = 10

	border_size = 2

	col.active_border = rgba($color_active$alpha_active)
	col.inactive_border = rgba($color_passive$alpha_passive)

	resize_on_border = false

	allow_tearing = false
}

decoration {
	rounding = 0

	active_opacity = 1.0
	inactive_opacity = 1.0

	shadow {
		enabled = false
	}

	blur {
		enabled = false
	}
}

animations {
	enabled = true

	bezier = linear, 0.75, 0.99, 0.69, 1

	animation = workspaces, 0
	animation = windows, 1, 3, linear, popin 80%
	animation = windowsOut, 1, 3, linear
	animation = windowsMove, 1, 3, linear
	animation = border, 1, 2, linear
	animation = fade, 1, 2, linear
}

###
### BINDS
###

$mod = SUPER
$shftMod = SUPER SHIFT
$ctrlMod = SUPER CONTROL

$execMod = CTRL ALT

$terminal    = kitty
$cliToTerm   = kitty -e
$fileManager = dolphin
$browser     = librewolf -P
$browserRF   = librewolf -P RF
$telegram    = Telegram
$calculator  = speedcrunch
$volumemixer = pavucontrol -t 3

$screenLock    = hyprlock

$screenshotScreen = grim - | wl-copy
$screenshotRegion = grim -g "$(slurp)" - | wl-copy
$screenshotWindow = grim -g "$(slurp)" - | wl-copy

$pickcolorHEX = hyprpicker -f hex | wl-copy
$pickcolorRGB = hyprpicker -f rgb | wl-copy

$brightnessUp   = brightnessctl --class=backlight set +10%
$brightnessDown = brightnessctl --class=backlight set 10%-

$volumeDown = wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.1-
$volumeMute = wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
$volumeUp   = wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.1+
$micMute    = wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle

$audioPlay  = playerctl play-pause
$audioPause = playerctl play-pause
$audioStop  = playerctl play-pause
$audioPrev  = playerctl previous
$audioNext  = playerctl next

$menu         = fuzzel
$menuBinaries = fuzzel
# Get, select and send to clipboard preffered item from clipboard history
$menuClipboard = cliphist list | fuzzel --width=90 --prompt /cliphist/ --dmenu | cliphist decode | wl-copy

# Wallpaper options
$bgSingleRestart = systemctl --user stop swaybg-random; systemctl --user restart swaybg-single
$bgRandomRestart = systemctl --user stop swaybg-single; systemctl --user restart swaybg-random

# Bar restart and show/hide
$barRestart = systemctl --user restart waybar
$barToggle  = pkill -SIGUSR1 waybar

$mountVault = $cliToTerm cryptomount
$closeVault = $cliToTerm cryptoclose

bind = $mod, ESC, submap, passthru
bind = $mod, ESC, submap, reset

# Application launch bindings
bind = $mod, Q, killactive,
bind = ALT, F4, killactive,

bind = $execMod, T, exec, $terminal
bind = $mod,     E, exec, $fileManager
bind = $execMod, E, exec, $browserRF
bind = $execMod, W, exec, $browser
bind = $execMod, Q, exec, $telegram
bind = $execMod, C, exec, $calculator
bind = $execMod, S, exec, $volumemixer

bind = $execMod, L, exec, $screenLock

bind =      , Print, exec, $screenshotScreen
bind = SHIFT, Print, exec, $screenshotRegion
bind = $shftMod,  S, exec, $screenshotRegion
bind = $mod,  PRINT, exec, $screenshotWindow

bind = $mod,     P, exec, $pickcolorHEX
bind = $ctrlMod, P, exec, $pickcolorRGB

bind = $mod,     D, exec, $menu
bind = ALT,  SPACE, exec, $menu
bind = $shftMod, D, exec, $menuBinaries
bind = $mod,     V, exec, $menuClipboard

bind = $ctrlMod, W, exec, $bgRandomRestart
bind = $shftMod, W, exec, $bgSingleRestart

bind = $ctrlMod, B, exec, $barRestart
bind = $mod,     B, exec, $barToggle

bind = $execMod, HOME, exec, $mountVault
bind = $execMod, END,  exec, $closeVault

# Keyboard Fn Binds
bind =,XF86MonBrightnessUp,   exec, $brightnessUp
bind =,XF86MonBrightnessDown, exec, $brightnessDown

bind =,XF86AudioLowerVolume, exec, $volumeDown
bind =,XF86AudioMute,        exec, $volumeMute
bind =,XF86AudioRaiseVolume, exec, $volumeUp
bind =,XF86AudioMicMute,     exec, $micMute

bind =,XF86AudioPlay,  exec, $audioPlay
bind =,XF86AudioPause, exec, $audioPause
bind =,XF86AudioStop,  exec, $audioStop
bind =,XF86AudioPrev,  exec, $audioPrev
bind =,XF86AudioNext,  exec, $audioNext

bind =,XF86Start,      exec, $menu
bind =,XF86Search,     exec, $menu
bind =,XF86Calculator, exec, $calculator

bind = $shftMod, F, togglefloating,
bind = $mod,     Z, fullscreen

bind = $mod, mouse_down, workspace, e-1
bind = $mod, mouse_up  , workspace, e+1

# Super + Left mouse
bindm = $mod, mouse:272, movewindow
# Super + Right mouse
bindm = $mod, mouse:273, resizewindow

gesture = 3, horizontal, workspace

bind = $shftMod, R, exec, hyprctl reload
# This shit keeps work after logging out and session keeps living
bind = $shftMod, Backspace, exec, pkill ksecretd && sleep 0.5s && uwsm stop

general {
	layout = master
}

master {
	new_status = master
	new_on_top = true
	mfact = 0.5
	drop_at_cursor = false
}

# Swap window with master
bind = $mod, x, layoutmsg, swapwithmaster auto

# Resizing split zone
bind = $mod, left,  layoutmsg, mfact -0.05
bind = $mod, h,     layoutmsg, mfact -0.05
bind = $mod, Equal, layoutmsg, mfact exact 0.5
bind = $mod, right, layoutmsg, mfact +0.05
bind = $mod, l,     layoutmsg, mfact +0.05
# Focus previous/next
bind = $mod,  up,   layoutmsg, cycleprev
bind = $mod,  k,    layoutmsg, cycleprev
bind = $mod,  down, layoutmsg, cyclenext
bind = $mod,  j,    layoutmsg, cyclenext
bind = ALT,       TAB,  layoutmsg, cyclenext
bind = SHIFT ALT, TAB,  layoutmsg, cycleprev
# Swap window
bind = $shftMod, up,    layoutmsg, swapprev
bind = $shftMod, k,     layoutmsg, swapprev
bind = $shftMod, down,  layoutmsg, swapnext
bind = $shftMod, j,     layoutmsg, swapnext
# Add/remove windows to master zone
bind = $mod, i,     layoutmsg, addmaster
bind = $mod, u,     layoutmsg, removemaster
# Master zone alignment
bind = $ctrlMod, left,  layoutmsg, orientationleft
bind = $ctrlMod, h,     layoutmsg, orientationleft
bind = $ctrlMod, right, layoutmsg, orientationright
bind = $ctrlMod, l,     layoutmsg, orientationright
bind = $ctrlMod, Equal, layoutmsg, orientationcenter
bind = $ctrlMod, up,    layoutmsg, orientationtop
bind = $ctrlMod, k,     layoutmsg, orientationtop
bind = $ctrlMod, down,  layoutmsg, orientationbottom
bind = $ctrlMod, j,     layoutmsg, orientationbottom

###
### INPUT
###

input {
	kb_layout = us,ru
	kb_options = grp:win_space_toggle,grp:caps_toggle,grp_led:scroll
	kb_variant =
	kb_model =
	kb_rules =

	follow_mouse = 1

	accel_profile = flat
	
	sensitivity = -0.2 # -1.0 - 1.0, 0 means no modification.

	touchpad {
		natural_scroll = true
		disable_while_typing = false
	}
}

device {
	name = syna32b6:00-06cb:ce17-touchpad
	accel_profile = adaptive
}

###
### Permissions
###

permission = /usr/bin/(grim|obs|hyprlock), screencopy, allow
permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-(hyprland|gtk|gnome|kde|wlr), screencopy, allow
permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal, screencopy, allow

permission = --gaming-keyboard.*, keyboard, allow
permission = at-translated-set-2-keyboard, keyboard, allow

permission = .*, screencopy, ask
permission = .*, keyboard, deny

###
### WINDOW RULES
###

# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more
# See https://wiki.hyprland.org/Configuring/Workspace-Rules/ for workspace rules

windowrulev2 = center,class:*

# Gamescope
windowrulev2 = fullscreen,class:^(gamescope)$

$popupSize = size 50% 65%

# Calculator
windowrulev2 = float,class:.*speedcrunch.*
windowrulev2 = size 30% 45%,class:.*speedcrunch.*
# Network connection editor
windowrulev2 = float,class:^(nm-connection-editor)$
windowrulev2 = $popupSize,class:^(nm-connection-editor)$
# Bluetooth manager
windowrulev2 = float,class:^(.blueman-manager-wrapped)$
windowrulev2 = $popupSize,class:^(.blueman-manager-wrapped)$
# Pulseaudio volume control
windowrulev2 = float,class:$(org.pulseaudio.pavucontrol)$
windowrulev2 = $popupSize,class:(org.pulseaudio.pavucontrol)$
# Open/Save dialog
windowrulev2 = float,class:^(xdg-desktop-portal-gtk)$
windowrulev2 = $popupSize,class:^(xdg-desktop-portal-gtk)$

windowrulev2 = float,class:.*freedesktop.impl.portal.*
windowrulev2 = $popupSize,class:*.freedesktop.impl.portal.*

# Open/Save/etc dialogs
windowrulev2 = center,class:^(Gimp-2.10)$,title:(Open)
windowrulev2 = $popupSize,class:^(Gimp-2.10)$,title:(Open)

windowrulev2 = center,title:(Save)
windowrulev2 = $popupSize,title:(Save)

windowrulev2 = center,title:(Save as)
windowrulev2 = $popupSize,title:(Save as)

windowrulev2 = center,title:(File upload)
windowrulev2 = $popupSize,title:(File upload)

windowrulev2 = float,class:^(org.telegram.desktop)$,title:(Media viewer)

windowrulev2 = suppressevent maximize, class:.*

# Screencast wayland windows to xorg clients tweak.
# (it create weird window, that needs to be hidden by this rules.
# Copied from hyprland wiki.
windowrulev2 = opacity 0.0 override, class:^(xwaylandvideobridge)$
windowrulev2 = noanim, class:^(xwaylandvideobridge)$
windowrulev2 = noinitialfocus, class:^(xwaylandvideobridge)$
windowrulev2 = maxsize 1 1, class:^(xwaylandvideobridge)$
windowrulev2 = noblur, class:^(xwaylandvideobridge)$
windowrulev2 = nofocus, class:^(xwaylandvideobridge)$

# No gaps when only 1 tiled window on a workspace
workspace = w[tv1], gapsout:0, gapsin:0
workspace = f[1], gapsout:0, gapsin:0
windowrule = bordersize 0, floating:0, onworkspace:w[tv1]
windowrule = rounding 0, floating:0, onworkspace:w[tv1]
windowrule = bordersize 0, floating:0, onworkspace:f[1]
windowrule = rounding 0, floating:0, onworkspace:f[1]

bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

bind = $mod SHIFT, 1, movetoworkspacesilent, 1
bind = $mod SHIFT, 2, movetoworkspacesilent, 2
bind = $mod SHIFT, 3, movetoworkspacesilent, 3
bind = $mod SHIFT, 4, movetoworkspacesilent, 4
bind = $mod SHIFT, 5, movetoworkspacesilent, 5
bind = $mod SHIFT, 6, movetoworkspacesilent, 6
bind = $mod SHIFT, 7, movetoworkspacesilent, 7
bind = $mod SHIFT, 8, movetoworkspacesilent, 8
bind = $mod SHIFT, 9, movetoworkspacesilent, 9
bind = $mod SHIFT, 0, movetoworkspacesilent, 10
